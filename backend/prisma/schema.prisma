// prisma/schema.prisma
// Define your database models

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            Int      @id @default(autoincrement())
  name          String
  email         String   @unique
  password_hash String
  role          String   // "student" or "admin"
  created_at    DateTime @default(now())

  @@map("users")
}

model JobRole {
  id           Int      @id @default(autoincrement())
  role_name    String   @unique
  description  String?
  demand_score Int      @default(0) // 0-100
  demand_level String   // "High", "Medium", "Low"
  updated_at   DateTime @updatedAt

  skills       RoleSkill[]
  roadmaps     Roadmap[]
  projects     Project[]

  @@map("job_roles")
}

model Skill {
  id         Int      @id @default(autoincrement())
  skill_name String   @unique
  category   String   // "Frontend", "Backend", "Tools", etc.
  created_at DateTime @default(now())

  role_skills RoleSkill[]

  @@map("skills")
}

model RoleSkill {
  id               Int     @id @default(autoincrement())
  role_id          Int
  skill_id         Int
  frequency_weight Int     @default(0) // 0-100

  role  JobRole @relation(fields: [role_id], references: [id], onDelete: Cascade)
  skill Skill   @relation(fields: [skill_id], references: [id], onDelete: Cascade)

  @@unique([role_id, skill_id])
  @@map("role_skills")
}

model Roadmap {
  id               Int    @id @default(autoincrement())
  role_id          Int
  phase_name       String // "Beginner", "Intermediate", "Advanced", "Projects", "Interview"
  step_title       String
  step_description String?
  step_order       Int

  role JobRole @relation(fields: [role_id], references: [id], onDelete: Cascade)

  @@index([role_id, step_order])
  @@map("roadmaps")
}

model Project {
  id                  Int     @id @default(autoincrement())
  role_id             Int
  project_title       String
  project_description String?
  difficulty_level    String  // "Easy", "Medium", "Hard"

  role JobRole @relation(fields: [role_id], references: [id], onDelete: Cascade)

  @@map("projects")
}
